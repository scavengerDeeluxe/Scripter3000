<Window x:Class="WpfApp3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
        xmlns:local="clr-namespace:WpfApp3"
        mc:Ignorable="d"
        Title="MainWindow" Height="958" Width="1060" Loaded="Window_Loaded">
    <Window.Resources>
        <Style x:Key="StackPanelStyle1" TargetType="{x:Type StackPanel}">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="Black" Offset="1"/>
                        <GradientStop Color="White" Offset="0"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid Margin="0,0,3,-35">
        <Grid Height="588" VerticalAlignment="Top" Loaded="Grid_Loaded">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>



            <Grid RenderTransformOrigin="0.501,0.68" Margin="211,10,206,526" OpacityMask="Black" Background="#FF312222">
                <TextBlock TextWrapping="Wrap" Margin="24,10,500,10" FontSize="22" FontWeight="Bold" Foreground="#FFCE6161"><Run Text="TargetPC"/><LineBreak/><Run/></TextBlock>
                <TextBox x:Name="txt_Target" TextWrapping="Wrap" Margin="156,10,191,10" AutomationProperties.Name="TargetPC" FontSize="16" FontWeight="Bold">
                    <AutomationProperties.LabeledBy>
                        <Label/>
                    </AutomationProperties.LabeledBy>
                </TextBox>
                <Button x:Name="btnTestConnection" Content="Test Conn" HorizontalAlignment="Left" Margin="474,0,0,0" VerticalAlignment="Center" Click="TestConnection_Click" Height="33" Width="72"/>
            </Grid>
            <TabControl Margin="10,54,10,50">
                <TabItem Header="Tasks" FontFamily="Trebuchet MS" FontSize="24">
                    <Grid Background="#FFE5E5E5" UseLayoutRounding="True" Height="432" Margin="0,0,756,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <ListView x:Name="lsv_adminTools"
         SelectionChanged="lsv_adminTools_SelectionChanged"
         DisplayMemberPath="Name"
         Height="244" IsSynchronizedWithCurrentItem="False" ItemsSource="{Binding tools}" FontSize="18" Background="#FF545353" Foreground="#FFD7FFF5" Width="267" />
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem AutomationProperties.IsOffscreenBehavior="Onscreen" IsSelected="False" Header="Scripts" FontFamily="Trebuchet MS" FontWeight="Bold" FontSize="24">
                    <Grid Background="#FFE5E5E5" Height="736">
                        <GridSplitter Width="5" Margin="0,485,0,-158"/>
                        <StackPanel Margin="0,0,0,333">
                            <TreeView x:Name="treeViewScripts" FontFamily="Trebuchet MS" FontSize="16" Height="396" Width="345" HorizontalAlignment="Left" MouseLeftButtonDown="treeViewScripts_MouseDoubleClick">
                                <TreeView.ItemTemplate>
                                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                        <TextBlock Text="{Binding Name}" />
                                    </HierarchicalDataTemplate>
                                </TreeView.ItemTemplate>
                            </TreeView>
                        </StackPanel>
                        <Grid Margin="352,2,-2,308">
                            <Button x:Name="OpenScriptLogs" Content="Pop-Out&#xA;Logs" Click="OpenLogsPopou" FontSize="16" FontFamily="Trebuchet MS" FontWeight="Bold" Height="45" Width="87" Margin="573,2,8,378"/>
                            <Button x:Name="SaveScript" Content="Save &#xA;Script" Margin="898,-226,-470,613" Click="SaveScript_Click" IsEnabled="False" Visibility="Hidden"/>
                            <ListView x:Name="lsv_jobs" SelectionChanged="lsv_jobs_SelectionChanged" ItemsSource="{Binding Jobs}" Margin="387,50,6,-16" FontSize="16" d:ItemsSource="{d:SampleData ItemCount=5}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Status" DisplayMemberBinding="{Binding Status}" />
                                        <GridViewColumn Header="Script" DisplayMemberBinding="{Binding ScriptName}" />
                                        <GridViewColumn Header="Target" DisplayMemberBinding="{Binding TargetPC}" />
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <Button x:Name="btnCancelJob" Content="Cancel&#xA; Selected" Margin="500,4,92,392" Click="CancelJob_Click" FontSize="12" Background="#FFEF7171" />
                        </Grid>
                        <avalonEdit:TextEditor  x:Name="editorScript" ShowLineNumbers="True" FontFamily="Consolas" SyntaxHighlighting="PowerShell" Background="White" FontSize="12" Foreground="#FF203830" Margin="348,5,291,288" UseLayoutRounding="True" LostFocus="editorScript_LostFocus" >
                            <avalonEdit:TextEditor.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform ScaleY="1" ScaleX="1"/>
                                    <SkewTransform AngleX="0.366"/>
                                    <RotateTransform/>
                                    <TranslateTransform/>
                                </TransformGroup>
                            </avalonEdit:TextEditor.RenderTransform>
                        </avalonEdit:TextEditor>
                    </Grid>
                </TabItem>
                <TabItem Margin="-2,-2,-73,0" Header="WMI MultiQ" Tag="WMI MultiQ" FontFamily="Trebuchet MS" FontSize="24" FontWeight="DemiBold">
                    <Grid>
                        <TextBox TextWrapping="Wrap" Margin="16,57,912,45"/>
                        <Label Content="Targets" HorizontalAlignment="Left" Margin="16,22,0,0" VerticalAlignment="Top" Width="108"/>
                        <Label Content="Query" HorizontalAlignment="Left" Margin="192,14,0,0" VerticalAlignment="Top" Width="108"/>
                        <DataGrid HorizontalAlignment="Left" Height="285" Margin="143,158,0,0" VerticalAlignment="Top" Width="859"/>
                        <Button Content="Query" HorizontalAlignment="Left" Height="19" Margin="152,134,0,0" VerticalAlignment="Top" Width="69" FontSize="13"/>
                        <Button Content="Abort" HorizontalAlignment="Left" Height="20" Margin="225,133,0,0" VerticalAlignment="Top" Width="45" FontSize="13"/>
                        <ListBox HorizontalAlignment="Left" Height="147" Margin="855,4,0,0" VerticalAlignment="Top" Width="168" d:ItemsSource="{d:SampleData ItemCount=5}" FontSize="10"/>
                        <TextBox HorizontalAlignment="Left" Height="33" Margin="279,123,0,0" TextWrapping="Wrap" Text="TextBox" VerticalAlignment="Top" Width="514"/>
                        <Button Content="Load" HorizontalAlignment="Left" Height="24" Margin="802,128,0,0" VerticalAlignment="Top" Width="48" FontSize="13"/>
                    </Grid>
                </TabItem>
            </TabControl>
            <Button x:Name="OpenScriptPopout" Content="View Script" Click="OpenScriptPopout_Click_1" RenderTransformOrigin="0.467,0.429" FontSize="12" Margin="948,44,18,511" Panel.ZIndex="4"/>
            <Button Click="Button_Click_1" Margin="858,42,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="40" Width="82" FontSize="16" Content="EXECUTE" FontFamily="Trebuchet MS" FontWeight="Bold"/>
        </Grid>
        <DataGrid d:ItemsSource="{d:SampleData ItemCount=5}" Margin="9,541,20,129"/>
        <DataGrid x:Name="dg_logs" HorizontalAlignment="Left" Height="299" Margin="7,539,0,0" VerticalAlignment="Top" Width="1025" d:ItemsSource="{d:SampleData ItemCount=5}" FontSize="14" FontWeight="Normal"/>
        <RichTextBox x:Name="editorLogs" FontFamily="Consolas"  Background="#FF383737" Foreground="#FF8CD68A" Margin="5,541,13,123" >
            <FlowDocument>
                <Paragraph/>
            </FlowDocument>
        </RichTextBox>
        <ComboBox x:Name="combo_fontsize" HorizontalAlignment="Left" Margin="952,871,0,0" VerticalAlignment="Top" Width="50" SelectionChanged="combo_fontsize_SelectionChanged"/>
        <Label Content="FontSize" HorizontalAlignment="Left" Margin="866,866,0,0" VerticalAlignment="Top" Width="68"/>

    </Grid>
</Window>
